//modified from original version to remove references to $.browser - may lose some cross browser functionality

!function(t){var e,r={backspace:8,tab:9,enter:13,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"?":191,minus:[189,109],plus:[187,107]},n={},a={},i=!1,s=function(e,r){var n=e;r.ctrl&&(n+="_ctrl"),r.alt&&(n+="_alt"),r.shift&&(n+="_shift");var a=function(t,e){return e&&16!==e&&17!==e&&18!==e&&(t+="_"+e),t};if(t.isArray(r.which)){var i=[];return t.each(r.which,function(t,e){i.push(a(n,e))}),i}return a(n,r.which)},c=function(e){var n={},a=e.split("+");return t.each(a,function(t,e){"ctrl"===e||"alt"===e||"shift"===e?n[e]=!0:n.which=r[e]||e.toUpperCase().charCodeAt()}),n},u=function(e){var r=e.tagName.toLowerCase(),n=e.type;return"input"===r&&t.inArray(n,["text","password","file","search"])>-1||"textarea"===r},h=function(r,n){if(e){var a={ctrl:n.ctrlKey,alt:n.altKey,shift:n.shiftKey,which:n.which},i=s(r,a),c=e[i];if(c){var h=u(n.target),o=!1;t.each(c,function(t,e){(!h||e.enableInInput)&&(o||(n.preventDefault(),o=!0),e.handler(n))})}}};t.Shortcuts={},t.Shortcuts.start=function(r){return r=r||"default",e=n[r],i?void 0:(t(document).bind("keydown.shortcuts",function(t){"keypress"===t.type&&t.which>=97&&t.which<=122&&(t.which=t.which-32),a[t.which]||h("down",t),a[t.which]=!0,h("hold",t)}),t(document).bind("keyup.shortcuts",function(t){a[t.which]=!1,h("up",t)}),i=!0,this)},t.Shortcuts.stop=function(){return t(document).unbind("keypress.shortcuts keydown.shortcuts keyup.shortcuts"),i=!1,this},t.Shortcuts.add=function(e){if(!e.mask)throw new Error("$.Shortcuts.add: required parameter 'params.mask' is undefined.");if(!e.handler)throw new Error("$.Shortcuts.add: required parameter 'params.handler' is undefined.");var r=e.type||"down",a=e.list?e.list.replace(/\s+/g,"").split(","):["default"];return t.each(a,function(a,i){n[i]||(n[i]={});var u=n[i],h=e.mask.toLowerCase().replace(/\s+/g,"").split(",");t.each(h,function(n,a){var i=c(a),h=s(r,i);t.isArray(h)||(h=[h]),t.each(h,function(t,r){u[r]||(u[r]=[]),u[r].push(e)})})}),this},t.Shortcuts.remove=function(e){if(!e.mask)throw new Error("$.Shortcuts.remove: required parameter 'params.mask' is undefined.");var r=e.type||"down",a=e.list?e.list.replace(/\s+/g,"").split(","):["default"];return t.each(a,function(a,i){if(!n[i])return!0;var u=e.mask.toLowerCase().replace(/\s+/g,"").split(",");t.each(u,function(e,a){var u=c(a),h=s(r,u);t.isArray(h)||(h=[h]),t.each(h,function(t,e){delete n[i][e]})})}),this}}(jQuery);